import z3

solver = z3.Solver()

#my vector of symbolic bytes
symbytes = [z3.BitVec(f"a{i}", 8) for i in range (23)]

for symbyte in symbytes:
	solver.add(symbyte > 0x20)
	solver.add(symbyte <= 0x7e)

solver.add(symbytes[0] == ord("f"))
solver.add(symbytes[1] == ord("l"))
solver.add(symbytes[2] == ord("a"))
solver.add(symbytes[3] == ord("g"))
solver.add(symbytes[4] == ord("{"))
solver.add(symbytes[22] == ord("}"))


#now we add all the 23 ifs

solver.add(-183 * symbytes[0] + -181 * symbytes[7]
+ -166 * symbytes[20]
+ 225 * symbytes[21]
+ -106 * symbytes[5]
+ -170 * symbytes[6]
+ 185 * symbytes[18]
+ 124 * symbytes[16]
+ -102 * symbytes[17]
+ 154 * symbytes[4]
+ 198 * symbytes[14]
+ -149 * symbytes[19]
+ 115 * symbytes[3]
+ -155 * symbytes[15]
+ 183 * symbytes[13]
+ -71 * symbytes[12]
+ -189 * symbytes[9]
+ 215 * symbytes[22]
+ 187 * symbytes[10]
+ 49 * symbytes[8]
- 39978
+ 57 * symbytes[1]
+ 3 * symbytes[2] + -25 * symbytes[11] == 0 )

solver.add(226 * symbytes[3]
+ -222 * symbytes[9]
+ 131 * symbytes[13]
+ -17 * symbytes[19]
+ -14 * symbytes[22]
+ -158 * symbytes[12]
+ -253 * symbytes[0]
+ -97 * symbytes[7]
+ 231 * symbytes[16]
+ 238 * symbytes[5]
+ 252 * symbytes[10]
+ 224 * symbytes[15]
+ -88 * symbytes[6]
- 174 * symbytes[8]
+ 125 * symbytes[20]
- 60 * symbytes[1]
- 94 * symbytes[2]
- 224 * symbytes[18]
- 137 * symbytes[11]
- (symbytes[4] << 7)
- 229 * symbytes[14]
+ 39470
+ 48 * symbytes[17] + -85 * symbytes[21] == 0 )

solver.add(50 * symbytes[6]
+ 209 * symbytes[10]
+ -49 * symbytes[0]
+ 179 * symbytes[8]
+ -41 * symbytes[7]
+ 159 * symbytes[19]
+ 149 * symbytes[12]
+ -138 * symbytes[4]
+ 240 * symbytes[3]
+ 151 * symbytes[18]
+ 210 * symbytes[5]
+ 134 * symbytes[14]
+ 50 * symbytes[1]
+ 132 * symbytes[2]
+ 145 * symbytes[20]
+ 197 * symbytes[13]
+ -226 * symbytes[15]
+ 212 * symbytes[9]
- 108 * symbytes[21]
+ 198 * symbytes[22]
- 201293
+ 234 * symbytes[17]
+ 27 * symbytes[11] + -57 * symbytes[16] == 0 )

solver.add(251 * symbytes[11]
+ -38 * symbytes[3]
+ 175 * symbytes[4]
+ 133 * symbytes[9]
+ -168 * symbytes[8]
+ 235 * symbytes[13]
+ 87 * symbytes[18]
+ 199 * symbytes[21]
+ -104 * symbytes[1]
+ -35 * symbytes[17]
+ 82 * symbytes[5]
+ -186 * symbytes[22]
+ -141 * symbytes[19]
+ 87 * symbytes[2]
+ 203 * symbytes[14]
+ -26 * symbytes[6]
+ 171 * symbytes[12]
+ 141 * symbytes[20]
+ 169 * symbytes[15]
- 20 * symbytes[16]
- 98 * symbytes[0]
+ 96 * symbytes[10]
- 134174
+ 95 * symbytes[7] == 0 )

solver.add(-78 * symbytes[6]
+ 151 * symbytes[22]
+ 151 * symbytes[12]
+ 231 * symbytes[21]
+ -245 * symbytes[16]
+ 186 * symbytes[15]
+ 235 * symbytes[8]
+ -195 * symbytes[10]
+ 234 * symbytes[7]
+ 216 * symbytes[20]
+ -85 * symbytes[9]
+ -196 * symbytes[5]
+ 240 * symbytes[4]
+ 134 * symbytes[19]
+ 4 * symbytes[1]
+ 140 * symbytes[2]
+ -81 * symbytes[0]
+ 208 * symbytes[18]
+ 138 * symbytes[13]
- (symbytes[3] << 7)
- 112877
- 181 * symbytes[17]
- 20 * symbytes[14]
+ 35 * symbytes[11] == 0 )

solver.add(237 * symbytes[0]
+ -238 * symbytes[22]
+ -7 * symbytes[16]
+ 197 * symbytes[13]
+ -229 * symbytes[5]
+ 142 * symbytes[2]
+ 110 * symbytes[11]
+ 83 * symbytes[7]
+ -186 * symbytes[9]
+ -137 * symbytes[21]
+ 22 * symbytes[20]
+ 35 * symbytes[8]
+ -152 * symbytes[1]
+ -102 * symbytes[6]
+ 218 * symbytes[19]
+ 90 * symbytes[18]
+ -123 * symbytes[4]
+ 33 * symbytes[3]
- 232 * symbytes[15]
+ 13 * symbytes[10]
+ 171 * symbytes[14]
- (symbytes[17] << 7)
- 15781
+ 214 * symbytes[12] == 0 )

solver.add(-106 * symbytes[21]
+ 233 * symbytes[19]
+ -69 * symbytes[15]
+ -204 * symbytes[0]
+ 57 * symbytes[3]
+ -13 * symbytes[13]
+ -141 * symbytes[17]
+ 145 * symbytes[11]
+ -111 * symbytes[20]
+ 14 * symbytes[9]
+ -53 * symbytes[14]
+ -198 * symbytes[10]
+ -159 * symbytes[16]
+ -140 * symbytes[8]
+ -38 * symbytes[12]
+ 139 * symbytes[5]
+ -167 * symbytes[4]
+ 221 * symbytes[18]
+ 122 * symbytes[6]
- 80 * symbytes[2]
- symbytes[22]
- 166 * symbytes[7]
+ 45734
+ 168 * symbytes[1] == 0 )

solver.add(-190 * symbytes[6]
+ 77 * symbytes[18]
+ 78 * symbytes[11]
+ 53 * symbytes[8]
+ 202 * symbytes[7]
+ 202 * symbytes[1]
+ -66 * symbytes[0]
+ 122 * symbytes[9]
+ -231 * symbytes[13]
+ 51 * symbytes[5]
+ 180 * symbytes[20]
+ 235 * symbytes[17]
+ 67 * symbytes[22]
+ 193 * symbytes[16]
+ -101 * symbytes[2]
+ -77 * symbytes[12]
+ 165 * symbytes[3]
+ 163 * symbytes[19]
+ 18 * symbytes[10]
+ 179 * symbytes[4]
- 16 * symbytes[15]
+ 235 * symbytes[21]
- 135132
+ 14 * symbytes[14] == 0 )

solver.add(71 * symbytes[18]
+ -91 * symbytes[20]
+ 240 * symbytes[2]
+ 242 * symbytes[6]
+ 209 * symbytes[4]
+ -15 * symbytes[11]
+ 45 * symbytes[8]
+ -178 * symbytes[22]
+ -211 * symbytes[0]
+ 8 * symbytes[19]
+ -78 * symbytes[12]
+ 103 * symbytes[21]
+ 85 * symbytes[9]
+ -161 * symbytes[3]
+ -245 * symbytes[1]
+ 170 * symbytes[15]
+ 196 * symbytes[16]
+ 67 * symbytes[14]
+ 197 * symbytes[7]
+ -23 * symbytes[13]
- 216 * symbytes[5]
- 78 * symbytes[10]
+ 18535 + -199 * symbytes[17] == 0 )

solver.add(143 * symbytes[7]
+ 180 * symbytes[1]
+ 187 * symbytes[18]
+ -169 * symbytes[12]
+ -58 * symbytes[13]
+ 135 * symbytes[11]
+ 59 * symbytes[10]
+ 86 * symbytes[5]
+ -218 * symbytes[22]
+ 211 * symbytes[3]
+ 249 * symbytes[20]
+ 74 * symbytes[16]
+ 202 * symbytes[8]
+ -111 * symbytes[15]
+ 195 * symbytes[19]
+ 247 * symbytes[0]
+ -209 * symbytes[2]
+ 99 * symbytes[6]
+ -253 * symbytes[9]
- 15 * symbytes[4]
+ 91 * symbytes[14]
- 78064
- 252 * symbytes[17]
+ 237 * symbytes[21] == 0 )

solver.add(254 * symbytes[2]
+ -93 * symbytes[12]
+ -71 * symbytes[10]
+ -58 * symbytes[4]
+ 34 * symbytes[20]
+ -191 * symbytes[18]
+ -207 * symbytes[8]
+ 175 * symbytes[6]
+ -167 * symbytes[7]
+ -125 * symbytes[17]
+ -81 * symbytes[1]
+ -69 * symbytes[0]
+ -156 * symbytes[3]
+ 137 * symbytes[5]
+ 156 * symbytes[14]
+ 134 * symbytes[19]
+ -99 * symbytes[11]
- 123 * symbytes[21]
+ 227 * symbytes[13]
- 124 * symbytes[16]
- 34 * symbytes[22]
+ 33620
+ 201 * symbytes[9] + -32 * symbytes[15] == 0 )

solver.add(-226 * symbytes[7]
+ 214 * symbytes[17]
+ 108 * symbytes[22]
+ 90 * symbytes[13]
+ -55 * symbytes[8]
+ 87 * symbytes[0]
+ -72 * symbytes[1]
+ -101 * symbytes[18]
+ 134 * symbytes[9]
+ 241 * symbytes[20]
+ 42 * symbytes[12]
+ -181 * symbytes[11]
+ 234 * symbytes[5]
+ -105 * symbytes[2]
- 163 * symbytes[3]
+ 96 * symbytes[16]
+ 177 * symbytes[6]
- 20 * symbytes[14]
+ 51 * symbytes[19]
- 21447
- 48 * symbytes[4]
- 222 * symbytes[15]
- 62 * symbytes[21]
+ 204 * symbytes[10] == 0 )

solver.add(-132 * symbytes[2]
+ 26 * symbytes[1]
+ 240 * symbytes[5]
+ -184 * symbytes[19]
+ -164 * symbytes[12]
+ -7 * symbytes[0]
+ 242 * symbytes[15]
+ -49 * symbytes[16]
+ -79 * symbytes[22]
+ -184 * symbytes[13]
+ 2 * symbytes[20]
+ 116 * symbytes[9]
+ -167 * symbytes[6]
+ 71 * symbytes[14]
+ -153 * symbytes[11]
- 78 * symbytes[3]
+ 35 * symbytes[8]
+ 11599
- 80 * symbytes[18]
+ 196 * symbytes[17]
- 40 * symbytes[7]
+ 141 * symbytes[10]
- 2 * symbytes[21]
+ 57 * symbytes[4] == 0 )

solver.add(-7 * symbytes[1]
+ -119 * symbytes[8]
+ 140 * symbytes[9]
+ 184 * symbytes[5]
+ -136 * symbytes[21]
+ 242 * symbytes[3]
+ 220 * symbytes[13]
+ -182 * symbytes[14]
+ -225 * symbytes[10]
+ -221 * symbytes[16]
+ -143 * symbytes[19]
+ 113 * symbytes[11]
+ 44 * symbytes[0]
+ -127 * symbytes[22]
+ -201 * symbytes[15]
+ -61 * symbytes[2]
- 26 * symbytes[18]
+ 225 * symbytes[7]
+ 3766
- 187 * symbytes[6]
+ 72 * symbytes[20]
- 46 * symbytes[12]
+ 3 * symbytes[17]
+ 168 * symbytes[4] == 0 )

solver.add(158 * symbytes[14]
+ -134 * symbytes[13]
+ 116 * symbytes[21]
+ -185 * symbytes[10]
+ 101 * symbytes[22]
+ -142 * symbytes[0]
+ 140 * symbytes[9]
+ -71 * symbytes[4]
+ -27 * symbytes[5]
+ -74 * symbytes[6]
+ 60 * symbytes[11]
+ 236 * symbytes[8]
+ 39 * symbytes[16]
+ -145 * symbytes[12]
+ -79 * symbytes[20]
+ 208 * symbytes[7]
+ 167 * symbytes[15]
+ 130 * symbytes[2]
- 90 * symbytes[17]
- (symbytes[19] << 8)
+ 187 * symbytes[1]
- 72 * symbytes[18]
+ 173 * symbytes[3] + -25705 == 0 )

solver.add(-248 * symbytes[14]
+ 185 * symbytes[10]
+ -82 * symbytes[13]
+ 90 * symbytes[0]
+ 240 * symbytes[9]
+ 70 * symbytes[15]
+ -208 * symbytes[20]
+ 108 * symbytes[22]
+ 97 * symbytes[7]
+ 226 * symbytes[19]
+ 87 * symbytes[1]
+ -151 * symbytes[6]
+ -138 * symbytes[16]
+ 221 * symbytes[3]
+ -136 * symbytes[12]
+ 87 * symbytes[17]
+ 217 * symbytes[2]
+ 246 * symbytes[21]
+ 164 * symbytes[8]
+ 9 * symbytes[5]
+ 231 * symbytes[4]
- 123517
+ 180 * symbytes[11] + -192 * symbytes[18] == 0 )

solver.add(-219 * symbytes[22]
+ 14 * symbytes[17]
+ 14 * symbytes[1]
+ 157 * symbytes[0]
+ -229 * symbytes[13]
+ -152 * symbytes[9]
+ -53 * symbytes[2]
+ -184 * symbytes[10]
+ 181 * symbytes[12]
+ 242 * symbytes[15]
+ 212 * symbytes[16]
+ 153 * symbytes[20]
+ -147 * symbytes[19]
+ -54 * symbytes[11]
- 169 * symbytes[6]
- 23 * symbytes[8]
+ 6 * symbytes[5]
+ 133 * symbytes[14]
- 1629
+ 63 * symbytes[4]
+ 97 * symbytes[18]
+ 27 * symbytes[7]
- 151 * symbytes[21]
+ 12 * symbytes[3] == 0 )

solver.add(252 * symbytes[0]
+ -143 * symbytes[18]
+ -181 * symbytes[14]
+ -227 * symbytes[5]
+ 172 * symbytes[16]
+ -131 * symbytes[21]
+ 122 * symbytes[15]
+ -52 * symbytes[7]
+ -23 * symbytes[2]
+ -173 * symbytes[11]
+ -122 * symbytes[17]
+ 211 * symbytes[6]
+ 98 * symbytes[22]
+ -178 * symbytes[12]
+ -40 * symbytes[4]
+ 70656
- 226 * symbytes[10]
- 144 * symbytes[13]
+ 29 * symbytes[8]
+ 72 * symbytes[20]
+ 155 * symbytes[3]
- 18 * symbytes[19]
+ 246 * symbytes[9] == 0 )

solver.add(221 * symbytes[10]
+ 61 * symbytes[13]
+ 122 * symbytes[7]
+ -249 * symbytes[14]
+ 220 * symbytes[1]
+ -251 * symbytes[12]
+ -249 * symbytes[15]
+ -114 * symbytes[20]
+ -193 * symbytes[2]
+ 106 * symbytes[22]
+ -203 * symbytes[21]
+ -152 * symbytes[8]
+ -171 * symbytes[3]
+ 51 * symbytes[0]
+ 79 * symbytes[11]
- 79 * symbytes[4]
+ 149 * symbytes[9]
+ 80 * symbytes[19]
+ 64992
- 153 * symbytes[6]
- (symbytes[5] << 6)
+ 23 * symbytes[17]
- 20 * symbytes[16] + -50 * symbytes[18] == 0 )

solver.add(138 * symbytes[12]
+ 161 * symbytes[10]
+ -23 * symbytes[2]
+ -41 * symbytes[8]
+ -90 * symbytes[21]
+ 76 * symbytes[14]
+ -198 * symbytes[7]
+ -45 * symbytes[5]
+ 244 * symbytes[20]
+ 76 * symbytes[6]
+ 173 * symbytes[9]
+ -132 * symbytes[1]
+ 227 * symbytes[0]
+ 42 * symbytes[17]
- 41 * symbytes[11]
+ 133 * symbytes[4]
- 8655
+ 101 * symbytes[3]
- 254 * symbytes[15]
+ 138 * symbytes[19]
- 120 * symbytes[13]
+ 109 * symbytes[16]
- 48 * symbytes[18] + -253 * symbytes[22] == 0 )

solver.add(-30 * symbytes[0]
+ 139 * symbytes[1]
+ 93 * symbytes[11]
+ -100 * symbytes[13]
+ -189 * symbytes[18]
+ 189 * symbytes[5]
+ -50 * symbytes[8]
+ -249 * symbytes[7]
+ 229 * symbytes[15]
+ 172 * symbytes[4]
+ -221 * symbytes[22]
+ -92 * symbytes[9]
+ 76 * symbytes[19]
+ -142 * symbytes[3]
+ 218 * symbytes[2]
+ 91 * symbytes[20]
- 236 * symbytes[21]
- 129 * symbytes[16]
+ 137 * symbytes[12]
- 124 * symbytes[17]
+ 84 * symbytes[14]
- 2495
- 30 * symbytes[6] + -11 * symbytes[10] == 0 )

solver.add(118 * symbytes[1]
+ 215 * symbytes[3]
+ -134 * symbytes[13]
+ 115 * symbytes[19]
+ -212 * symbytes[9]
+ -66 * symbytes[12]
+ 178 * symbytes[14]
+ 101 * symbytes[15]
+ 220 * symbytes[16]
+ 246 * symbytes[18]
+ 116 * symbytes[0]
+ -193 * symbytes[17]
+ -223 * symbytes[5]
+ 51 * symbytes[8]
- 10 * symbytes[21]
+ 114 * symbytes[22]
- (symbytes[20] << 7)
+ 249 * symbytes[7]
+ 17 * symbytes[4]
- 66 * symbytes[10]
+ 36 * symbytes[2]
- 75 * symbytes[6]
- 58358 + -226 * symbytes[11] == 0 )

solver.add(46 * symbytes[18]
+ -118 * symbytes[10]
+ 219 * symbytes[4]
+ -156 * symbytes[9]
+ 70 * symbytes[5]
+ 56 * symbytes[20]
+ 116 * symbytes[3]
+ -108 * symbytes[21]
+ -119 * symbytes[17]
+ -83 * symbytes[13]
+ -152 * symbytes[19]
+ -76 * symbytes[22]
+ 188 * symbytes[0]
+ -81 * symbytes[15]
+ 98 * symbytes[11]
+ -215 * symbytes[14]
+ -215 * symbytes[6]
+ -35 * symbytes[12]
- 72 * symbytes[8]
- 132 * symbytes[7]
+ 10 * symbytes[1]
+ 103 * symbytes[2]
+ 54203 + -156 * symbytes[16] == 0 )

print(solver.check())
model = solver.model()
flag = "".join([chr(model.eval(symbyte).as_long()) for symbyte in symbytes])
print(flag)
